# Проектирование высоконагруженной электронной энциклопедии

## Содержание

- ### [1. Тема, целевая аудитория и функционал](#1_part)
- ### [2. Расчет нагрузки](#2_part)
- ### [Список источников](#sources)

## 1. Тема, целевая аудитория и функционал <a name="1_part"></a>

### Тема

Википедия - это веб-сайт, представляющий собой свободную энциклопедию, которую создают и редактируют добровольцы со всего мира. Это один из крупнейших источников информации в Интернете ввиду своей уникальной модели коллективного редактирования и открытости. Он содержит огромное количество статей по различным темам: от науки и истории до культуры и техники.

### Целевая аудитория

- 133 млн активных пользователей в месяц
- 4.5 млн активных пользователей в день
- 47 млн зарегистрированных пользователей

#### Читатели

- средний возраст - 36 лет
- 55% читателей - мужчины, 45% - женщины

#### Зарегистрированные пользователи

- 84% редакторов - мужчины
- 59% редакторов в возрасте от 17 до 40 лет, а 13% - в возрасте 16 лет и младше

Продукт рассчитан на СНГ рынок, поэтому рассмотрим региональную аудиторию подробнее.

#### Распределение пользователей по странам

| Страна    | %  | чел, млн |
|-----------|----|----------|
| Россия    | 67 | 89,1     |
| Украина   | 11 | 14,6     |
| Беларусь  | 4  | 5,3      |
| Казахстан | 3  | 4        |
| Другое    | 15 | 20       |


### Основной функционал

1. Просмотр статей
2. Создание и редактирование статей
3. Регистрация и аутентификация пользователей
4. Поиск

## 2. Расчет нагрузки <a name="2_part"></a>

### Продуктовые метрики

- MAU: 133M
- DAU: 4.5M
- Среднее время на сайте: 00:04:44
- Среднее количество посещенных страниц за сессию: 3.45

#### Среднее количество действий пользователя по типам в день

| Действие                     | Количество  |
|------------------------------|-------------|
| Просмотр статей              | 30 000 000  |
| Создание и редактирование    | 4 500 000   |
| Регистрация и аутентификация | 330         |
| Поиск                        | ?           |

### Технические метрики

#### Общие данные 

| Тип                             | Количество, млн |
|---------------------------------|-----------------|
| Страницы                        | 60              |
| Статьи                          | 6,8             |
| Загруженные файлы               | 0,9             |
| Изменения статей                | 1 200           |
| Зарегистрированные пользователи | 47              |

#### Размер хранилища

Средний размер фото - 35кб

Facts:

- согласно статистике, на 1 января 2024 года русский раздел Википедии содержал 1,955 млн статей, 1 040 млн слов (токенов), то есть средний размер статьи составляет 1040119738 / 1955306 = 532 слова
- размер русской Википедии без учёта иллюстраций примерно составляет 1290 томов формата БСЭ
- согласно статистике файлов, на 28 ноября 2023 года русский раздел Википедии содержал 245 338 показываемых изображений (растровых и векторных), не считая изображений на Викискладе
- если считать, что в среднем одна иллюстрация в Большой советской энциклопедии занимает 1/10 страницы, то в ней поместилось бы (без текста и таблиц) 202 970 изображений, то есть в среднем по 6547 изображений в томе
- 245 338 ÷ 6547 ≈ 37,47 — то есть если учесть изображения, напечатанные хотя бы в таком разрешении, как в Большой советской энциклопедии, то к указанным выше 1290 томам надо прибавить ещё 37 томов!

#### Сетевой трафик

Получить исходя из размера запроса и количества RPS

| Тип трафика | Пиковое потребление | Суммарный суточный трафик |
|-------------|---------------------|---------------------------|
| Просмотр статьи                  | Рассчитывается | Рассчитывается |
| Загрузка файлов                  | Рассчитывается | Рассчитывается |
| Создание / редактирование статей | Рассчитывается | Рассчитывается |
| Регистрация / аутентификация     | Рассчитывается | Рассчитывается |

Рассчет:

#### RPS
| Тип запроса                      | RPD        | RPS   |
|----------------------------------|------------|-------|
| Просмотр статьи                  | 30 000 000 | 347  |
| Загрузка файлов                  | 8 300      | 0,096 |
| Создание / редактирование статей | 4 500 000  | 52    |
| Регистрация / аутентификация     | 330        | 0,003 |


## Список источников <a name="sources"></a>

- ### [Анализ веб-сайта Wikipedia](https://www.similarweb.com/ru/website/ru.wikipedia.org/)
- ### [Анализ действий пользователей Wikipedia](https://pageviews.wmcloud.org/siteviews/?platform=all-access&source=pageviews&agent=user&start=2024-01-25&end=2024-02-25&sites=ru.wikipedia.org)
- ### [Wikipedia: размер в томах](https://ru.wikipedia.org/wiki/%D0%92%D0%B8%D0%BA%D0%B8%D0%BF%D0%B5%D0%B4%D0%B8%D1%8F:%D0%A0%D0%B0%D0%B7%D0%BC%D0%B5%D1%80_%D0%B2_%D1%82%D0%BE%D0%BC%D0%B0%D1%85#:~:text=%D0%A1%D0%B5%D0%B3%D0%BE%D0%B4%D0%BD%D1%8F%20%D0%B2%20%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%BE%D0%BC%20%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5%20%D0%92%D0%B8%D0%BA%D0%B8%D0%BF%D0%B5%D0%B4%D0%B8%D0%B8,1040119738%20%2F%201955306%20%3D%20532%20%D1%81%D0%BB%D0%BE%D0%B2%D0%B0.)